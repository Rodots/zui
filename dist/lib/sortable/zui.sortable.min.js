/*!
 * ZUI: 排序 - v1.10.0 - 2024-06-17
 * http://openzui.com
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2024 cnezsoft.com; Licensed MIT
 */
+function(t,e,r){"use strict";if(!t.fn.droppable)return void console.error("Sortable requires droppable.js");var o="zui.sortable",n={selector:"li,div",dragCssClass:"invisible",sortingClass:"sortable-sorting"},a="order",s=function(e,r){var o=this;o.$=t(e),o.options=t.extend({},n,o.$.data(),r),o.init()};s.DEFAULTS=n,s.NAME=o,s.prototype.init=function(){var e,r,o=this,n=o.$,s=o.options,i=s.selector,l=s.containerSelector,f=s.sortingClass,d=s.dragCssClass,g=s.targetSelector,p=s.reverse,c=s.moveDirection,u=function(e){e=e||o.getItems(1);var r=e.length;r&&e.each(function(e){var o=p?r-e:e;t(this).attr("data-"+a,o).data(a,o)})};g||u(),n.droppable({handle:s.trigger,target:g?g:l?i+","+l:i,selector:i,container:s.container||n,always:s.always,flex:!0,lazy:s.lazy,canMoveHere:s.canMoveHere,dropToClass:s.dropToClass,before:s.before,nested:!!l,mouseButton:s.mouseButton,noShadow:s.noShadow,dropOnMouseleave:s.dropOnMouseleave,stopPropagation:s.stopPropagation,start:function(t){if(d&&t.element.addClass(d),e=!1,o.$element=t.element,!c&&t.targets.length>1){var r=t.targets.eq(0).offset(),n=t.targets.eq(1).offset();c=Math.abs(r.left-n.left)>Math.abs(r.top-n.top)?"h":"v"}u(),o.trigger("start",t)},drag:function(t){if(n.addClass(f),t.isIn){var s=t.target,d=t.element,g=l&&s.is(l);if(g)return void(s.children(i).filter(".dragging").length||(s.append(d),u($),o.trigger(a,{list:$,element:d})));var h=d.data(a),v=s.data(a);if(h!==v){var m="h"===c?"left":"top",b=t.mouseOffset[m]-t.lastMouseOffset[m];if(0!==b){var y=h>v?p:!p;if(!(b<0&&y||b>0&&!y)){r=y?"after":"before",s[r](d),e=!0,o.$target=s,o.$element=d;var $=o.getItems(1);u($),o.trigger(a,{insert:r,target:s,list:$,element:d})}}}}},finish:function(t){d&&t.element&&t.element.removeClass(d),n.removeClass(f),o.trigger("finish",{insert:r,target:o.$target,list:o.getItems(),element:o.$element,changed:e}),o.$element=null,o.$target=null}})},s.prototype.destroy=function(){this.$.droppable("destroy"),this.$.data(o,null)},s.prototype.reset=function(){this.destroy(),this.init()},s.prototype.getItems=function(e){var r,o=this,n=o.options.targetSelector;return r=n?"function"==typeof n?n(o.$element,o.$):o.$.find(n):o.$.find(o.options.selector),r=r.not(".drag-shadow"),e?r:r.map(function(){var e=t(this);return{item:e,order:e.data("order")}})},s.prototype.trigger=function(e,r){return t.zui.callEvent(this.options[e],r,this)},t.fn.sortable=function(e){return this.each(function(){var r=t(this),n=r.data(o),a="object"==typeof e&&e;n?"object"==typeof e&&n.reset():r.data(o,n=new s(this,a)),"string"==typeof e&&n[e]()})},t.fn.sortable.Constructor=s}(jQuery,window,document);